CREATE TABLE dispositivo(
	IP varchar(20) NOT NULL,
	HostName text,
	Type text,
	Mac text,
	Vendor text,
	Uptime int,
	State text,
	CONSTRAINT DISPOSITIVO_PK PRIMARY KEY(IP)
);
CREATE TABLE port(
	ID int AUTO_INCREMENT not null,
	IP varchar(20) NOT NULL,
	
	Port int,
	Type text,
	State text,
	Name text,
	Product text,
	Version text,
	ExtraInfor text,
	Conf int,
	Cpe text,

	CONSTRAINT PORT_PK PRIMARY KEY(ID),
CONSTRAINT IP_DISPOSITIVO_PORT_FK FOREIGN KEY (IP) REFERENCES dispositivo(IP) ON DELETE CASCADE ON UPDATE CASCADE

);

CREATE TABLE port_script(
	ID int AUTO_INCREMENT not null,
	ID_Port int not null,
	Llave text,
	Valor text,

CONSTRAINT ID_PORT_PORT_SCRIPT_FK FOREIGN KEY (ID_Port) REFERENCES port(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT PORT_SCRIPT_PK PRIMARY KEY(ID)
);

CREATE TABLE host_script(
	ID int AUTO_INCREMENT not null,
	IP varchar(20) NOT NULL,
	Llave text,
	Valor text,

CONSTRAINT ID_Dispositivo_Host_SCRIPT_FK FOREIGN KEY (IP) REFERENCES dispositivo(IP) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT HOST_SCRIPT_PK PRIMARY KEY(ID)
);

CREATE TABLE os_script(
	ID int AUTO_INCREMENT not null,
	IP varchar(20) NOT NULL,
	Name text,
	Accuracy int,
	Line int,
	
CONSTRAINT ID_Dispositivo_os_SCRIPT_FK FOREIGN KEY (IP) REFERENCES dispositivo(IP) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT os_SCRIPT_PK PRIMARY KEY(ID)
);
CREATE TABLE os_class(
ID int AUTO_INCREMENT not null,
	ID_os_script int,
Type text,
	Vendor text,
	Osfamily text,
	Osgen text,
	Accuracy int,
	Cpe text,
CONSTRAINT ID_os_SCRIPT_os_class_FK FOREIGN KEY (ID_os_script) REFERENCES os_script(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT os_class_PK PRIMARY KEY(ID)

);




CREATE TABLE app(
	IP varchar(20) NOT NULL,
	ID int AUTO_INCREMENT not null,
	Port int  NOT NULL,
CONSTRAINT IP_DISPOSITIVO_APP_FK FOREIGN KEY (IP) REFERENCES dispositivo(IP) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT APP_PK PRIMARY KEY(ID)
);
CREATE TABLE app_UPnP(
	ID int AUTO_INCREMENT not null,
	Name text NOT NULL,
	ID_APP int NOT NULL,
	CONSTRAINT ID_APP_APP_APP_UPNP_FK FOREIGN KEY (ID_APP) REFERENCES app(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT APP_UPNP_PK PRIMARY KEY(ID)
);
CREATE TABLE service_UPnP(
	Name varchar(100) NOT NULL,
	ID_Name text NOT NULL,
	SCPD text NOT NULL,
	ControlUrl text NOT NULL,
	EventUrl text NOT NULL,
	BaseUrl text NOT NULL,
	ID int AUTO_INCREMENT not null,
	ID_APP int not null,
	CONSTRAINT ID_APP_UPNP_SERVICE_UPNP_FK FOREIGN KEY (ID_APP) REFERENCES app_UPnP(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT SERVICE_UPNP_PK PRIMARY KEY(ID)
);
CREATE TABLE action_UPnP(
	Name varchar(100) NOT NULL,
	ID_SERVICE int not null,
	ID int AUTO_INCREMENT not null,
CONSTRAINT ID_SERVICE_UPNP_ACTION_UPNP_FK FOREIGN KEY (ID_SERVICE ) REFERENCES service_UPnP(ID) ON DELETE CASCADE ON UPDATE CASCADE,

CONSTRAINT ACTION_UPNP_PK PRIMARY KEY(ID)
);
CREATE TABLE input_arg_UPnP(
	ID_ACTION int NOT NULL,
	Name text NOT NULL,
	DataType varchar(20) NOT NULL,
	AllowedValueList text NOT NULL,
	ID int AUTO_INCREMENT not null,
CONSTRAINT ID_ACTION_UPNP_INPUT_ARG_UPNP_FK FOREIGN KEY (ID_ACTION) REFERENCES action_UPnP(ID) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT INPUT_ARG_UPNP_PK PRIMARY KEY(ID)

);
CREATE TABLE output_arg_UPnP(
	ID_ACTION int NOT NULL,
	Name text NOT NULL,
	DataType varchar(20) NOT NULL,
	AllowedValueList text NOT NULL,
	ID int AUTO_INCREMENT not null,
CONSTRAINT ID_ACTION_UPNP_OUTPUT_ARG_UPNP_FK FOREIGN KEY (ID_ACTION) REFERENCES action_UPnP(ID) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT OUTPUT_ARG_UPNP_PK PRIMARY KEY(ID)

);
CREATE TABLE vulnerability_UPnP(
	ID_SERVICE int not null,
	ID int AUTO_INCREMENT not null,
CVE text,
CWE text,
	CVEurl text,
	CWEurl text,
	CWEdescr text,
	Lang text,
	Description text,
	PublishDate datetime NOT NULL,
	LastModifiedDate datetime NOT NULL,


	CONSTRAINT ID_SERVICE_UPNP_VULNERABILITY_UPNP_FK FOREIGN KEY (ID_SERVICE) REFERENCES service_UPnP(ID) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT VULNERABILITY_UPNP_PK PRIMARY KEY(ID)


);




CREATE TABLE app_mDNS(
	ID int AUTO_INCREMENT not null,
	ID_APP int NOT NULL,
	CONSTRAINT ID_APP_APP_APP_MDNS_FK FOREIGN KEY (ID_APP) REFERENCES app(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT APP_MDNS_PK PRIMARY KEY(ID)
);

CREATE TABLE service_mDNS(
	ID int AUTO_INCREMENT not null,
	ID_APP_MDNS int not null,
Name text NOT NULL,
	Type text NOT NULL,
Weight int,
	Priority int,
	Server varchar(50) NOT NULL,
	InterfaceIndex int,
CONSTRAINT ID_APP_MDNS_SERVICE_MDNS_FK FOREIGN KEY (ID_APP_MDNS) REFERENCES app_mDNS(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT SERVICE_MDNS_PK PRIMARY KEY(ID)
);
CREATE TABLE property_mDNS(
	ID int AUTO_INCREMENT not null,
	ID_SERVICE_MDNS int not null,
	Llave varchar(50) not null,
	Valor varchar(50) not null,
	CONSTRAINT ID_SERVICE_MDNS_PROPERTY_MDNS_FK FOREIGN KEY (ID_SERVICE_MDNS) REFERENCES service_mDNS(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT PROPERTY_MDNS_PK PRIMARY KEY(ID)
);

CREATE TABLE vulnerability_mDNS(
	ID_SERVICE int not null,
	ID int AUTO_INCREMENT not null,
CVE text,
CWE text,
	CVEurl text,
	CWEurl text,
	CWEdescr text,
	Lang text,
	Description text,
PublishDate datetime NOT NULL,
	LastModifiedDate datetime NOT NULL,



	CONSTRAINT ID_SERVICE_MDNS_VULNERABILITY_MDNS_FK FOREIGN KEY (ID_SERVICE) REFERENCES service_mDNS(ID) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT VULNERABILITY_MDNS_PK PRIMARY KEY(ID)


);


CREATE TABLE app_WSDiscovery(
	ID int AUTO_INCREMENT not null,
	ID_APP int NOT NULL,
	CONSTRAINT ID_APP_APP_APP_WSDiscovery_FK FOREIGN KEY (ID_APP) REFERENCES app(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT APP_WSDiscovery_PK PRIMARY KEY(ID)
);

CREATE TABLE service_WSDiscovery(
	ID int AUTO_INCREMENT not null,
	ID_APP_WSDiscovery int not null,
EPR text NOT NULL,
	InstanceId int,
MessageNumber int,
	MetadataVersion int,
	XAddrs text NOT NULL,
CONSTRAINT ID_APP_WSDiscovery_SERVICE_WSDiscovery_FK FOREIGN KEY (ID_APP_WSDiscovery) REFERENCES app_WSDiscovery(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT SERVICE_WSDiscovery_PK PRIMARY KEY(ID)
);

CREATE TABLE scope_WSDiscovery(
	ID int AUTO_INCREMENT not null,
	ID_SERVICE int NOT NULL,
	MatchBy text,
	QuotedValue text,
	Value text,
CONSTRAINT ID_SERVICE_WSDiscovery_scope_WSDiscovery_FK FOREIGN KEY (ID_SERVICE) REFERENCES service_WSDiscovery(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT scope_WSDiscovery_PK PRIMARY KEY(ID)

);

CREATE TABLE type_WSDiscovery(
	ID int AUTO_INCREMENT not null,
	ID_SERVICE int NOT NULL,
	TypeName text NOT NULL,
	CONSTRAINT ID_SERVICE_WSDiscovery_type_WSDiscovery_FK FOREIGN KEY (ID_SERVICE) REFERENCES service_WSDiscovery(ID) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT TYPE_WSDiscovery_PK PRIMARY KEY(ID)
);
CREATE TABLE vulnerability_WSDiscovery(
	ID_SERVICE int not null,
	ID int AUTO_INCREMENT not null,
CVE text,
CWE text,
	CVEurl text,
	CWEurl text,
	CWEdescr text,
	Lang text,
	Description text,
	PublishDate datetime NOT NULL,
	LastModifiedDate datetime NOT NULL,



	CONSTRAINT ID_SERVICE_WSDiscovery_VULNERABILITY_WSDiscovery_FK FOREIGN KEY (ID_SERVICE) REFERENCES service_WSDiscovery(ID) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT VULNERABILITY_WSDiscovery_PK PRIMARY KEY(ID)
);


